<template>
  <div class="row">
    <div class="col-sm-12">
      <form>
        <div class="col-sm-3">
          <div class="form-group">
            <label>Venues:</label>
            <div class="checkbox" repeat.for="venue of venues">
              <label>
                <input
                  type="checkbox"
                  change.delegate="toggleVenue(venue.id)"
                  checked="isVanueIncluded(venue.id)">
                  <label>
                    ${venue.name}
                  </label>
              </label>
            </div>
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
            <label for="sel1">Genres:</label>
            <div class="checkbox">
              <label>
                <input
                 type="checkbox"
                 change.delegate="toggleGenreIgnore()"
                 value.bind="search.filter.ignoreGenreFilter">
                All
              </label>
            </div>
            <select
               class="form-control"
               id="sel2"
               disabled.bind="search.filter.ignoreGenreFilter"
               multiple
               change.delegate="toggleGenre($event.target.options)"
               size="13">
              <option
               repeat.for="genre of genres"
               value="${genre.id}"
               selected="search.filter.genres.includes(genre.id)">
                ${genre.name}
              </option>
            </select>
          </div>
        </div>
        <div class="col-sm-3">
          <div class="form-group">
           <label for="sel1">Composers:</label>
           <div class="checkbox">
             <label>
               <input
                type="checkbox"
                change.delegate="toggleAuthorIgnore()"
                value.bind="search.filter.ignoreAuthorFilter">
               All
             </label>
           </div>
           <select
              class="form-control"
              id="sel1"
              disabled.bind="search.filter.ignoreAuthorFilter"
              multiple
              change.delegate="toggleAuthor($event.target.options)"
              size="13">
             <option
              repeat.for="author of authors"
              value="${author.id}"
              selected="search.filter.authors.includes(author.id)">
               ${author.name}
             </option>
           </select>
          </div>
        </div>
        <div class="col-sm-2">
          <div class="center">
            <label>Time range:</label>
            <div class="checkbox">
              <label>
                <input
                 type="checkbox"
                 change.delegate="toggleStartDateIgnore()"
                 value="${search.filter.ignoreStartDateFilter}">
                No start date limit
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input
                 type="checkbox"
                 change.delegate="toggleEndDateIgnore()"
                 value="${search.filter.ignoreEndDateFilter}">
                No end date limit
              </label>
            </div>
            <div class="input-group">
              <input
                id="start-date"
                disabled.bind="search.filter.ignoreStartDateFilter"
                value.bind="search.filter.startDate"
                type="text"
                class="form-control">
              <span class="input-group-addon"><i class="fa fa-calendar prefix"></i></span>
            </div>
            <div class="input-group">
              <input
                id="end-date"
                disabled.bind="search.filter.ignoreEndDateFilter"
                value.bind="search.filter.endDate"
                type="text"
                class="form-control">
              <span class="input-group-addon"><i class="fa fa-calendar prefix"></i></span>
            </div>
          </div>
        </form>
        </div>
    </div>
  </div>
  <div class="row" style="margin-top: 30px;">
    <div
      class="col-sm-12 col-sm-offset-0
             col-md-6 col-md-offset-3
             col-lg-6 col-lg-offset-3">
      <div class="center">
        <form class="form-inline">
          <div class="input-group">
            <span class="input-group-addon"><i class="fa fa-search prefix"></i></span>
            <input
              id="search"
              type="text"
              class="form-control"
              name="search"
              keyup.delegate="editSearch($event.target.value)"
              value.to-view="search.filter.search"
              placeholder="Search"
              ></input>
          </div>

          <button
            class="btn btn-primary"
            click.delegate="submitFilter()">
            Search
          </button>

          <button
            class="btn btn-primary"
            disabled="isLoggedIn"
            click.delegate="createWatchdog()">
            Create watchdog
          </button>
        </form>
      </div>
    </div>
  </div>
  <div class="row" style="margin-top: 35px;">
    <div class="col-sm-12">
      <ul if.bind="numberOfPages > 1" class="pagination">
        <li
          repeat.for="i of numberOfPages"
          click.delegate="setGigPage(i)"
          class="${currentPage === i ? 'active' : ''}">
          <a>
            ${i + 1}
          </a>
        </li>
      </ul>

      <div class="list-group">
        <div
          class="row"
          style="height: 300px; margin-botton: 30px;"
          repeat.for="gig of search.gig.filtered"
          route-href="route: details; params.bind: {id: gig.id}">
          <div style="height: 100%;" class="col-sm-3">
            <img style="width: 100%;" src="${gig.imageUrl}" />
          </div>
          <div class="col-sm-6">
            <h4>
              ${gig.name}
              <a href.bind="gig.url" style="font-size: 80%;">(${gig.url})</a>
            </h4>
            <h8 innerhtml.bind="gig.description"></h8>
          </div>
          <div class="col-sm-3" style="margin-top: 70px;">
            <time datetime="${getStringDateTime(gig.timetamp)}" class="date-as-calendar inline-flex size2x">
              <span class="weekday">${getDayOfWeek(gig.timetamp)}</span>
              <span class="day">${getDayOfMonth(gig.timetamp)}</span>
              <span class="month">${getMonth(gig.timetamp)}</span>
              <span class="year">${getYear(gig.timetamp)}</span>
            </time>
          </div>
        </div>
      </div>

      <ul if.bind="numberOfPages > 1" class="pagination">
        <li
          repeat.for="i of numberOfPages"
          click.delegate="setGigPage(i)"
          class="${currentPage === i ? 'active' : ''}">
          <a>
            ${i + 1}
          </a>
        </li>
      </ul>
    </div>
  </div>
</template>
